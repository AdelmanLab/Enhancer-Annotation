# Enhancer-Annotation
Tools for filtering and annotating dREG peaks and ChIP-seq peaks. Developed by Andrew Field for the purposes of filtering and annotating dREG peaks generated from PRO-seq data though these tools have flexibility to accept ChIP-seq peaks generated by MACS2 or other similar tools.

## Required Tools and Inputs
### Useful links:
Repeatmasker track in mm10: http://hgdownload.soe.ucsc.edu/goldenPath/mm10/database/rmsk.txt.gz

Repeatmasker track in hg38: http://hgdownload.soe.ucsc.edu/goldenPath/hg38/database/rmsk.txt.gz

### Required R Packages: 

optparse

dplyr

ggplot2

IRanges

tidyr

vroom

### Other Required Tools:

BedTools: https://bedtools.readthedocs.io/en/latest/content/installation.html

bedops: https://bedops.readthedocs.io/en/latest/

ucsc-tools: https://hgdownload.soe.ucsc.edu/downloads.html

### Required Inputs:

Active Transcript Annotation
Pipeline developed by Ben Martin and Claudia Mimoso. Using a combination of RNA-seq and PRO-seq, dominant active transcript models are assigned. **NOTE: Use 5' mapped bedgraphs for this pipeline!!**
Detailed information on how to run the pipeline can be found on GitHub: https://github.com/AdelmanLab/GeneAnnotationScripts

dREG Transcribed Locus Annotation
Pipeline developed by Charles Danko. Generates BED file of divergent transcribed loci from nascent RNA-seq (including PRO-seq and GRO-seq) data. **Default parameters are recommended. Use un-normalized merged bigwigs (forward and reverse) as input.**
Detailed information on how to run dREG can be found on GitHub: https://github.com/Danko-Lab/dREG

## Initial Filtering and Naming of dREG Peaks
Script developed by Andrew Field. Raw dREG peak output is filtered by score and p-value then converted into normal bed file format.

Required R Packages: optparse, dplyr, ggplot2

Typical Usage
```
Rscript --vanilla dRIP_filt.R -i <dREG output>.peak.full.bed -o <output prefix> -s 0.5 -p 0.025 -b <bedGraph manifest>.csv -c 10 -n 1
```
Replace <> brackets with your relevant file names. You'll need to decompress the *[dREG output].peak.full.bed.gz* output in order to use it here. The "--vanilla" flag allows you to pass arguments from bash to R. An example of an appropriate bedGraph manifest follows below. You may want to change the -n flag to the number of biological replicates in your data set (eg -n 2 for samples with biological duplicates).

Bedgraph manifest file ("bedgraph_manifest.csv") format:
```
</path/to/bedg1_f>.bedgraph,</path/to/bedg1_r>.bedgraph,1
</path/to/bedg2_f>.bedgraph,</path/to/bedg2_r>.bedgraph,1
<bedgraph_forward>,<bedgraph_reverse>,<DepthNormFactor>
...
```
If the samples all have similar sequencing depth, use 1 as the normalization factor. However, if samples vary by more than 2 fold in sequencing depth, it is recommended to depth normalize the bedgraphs by introducing a depth normalization size factor (bedgraph count / norm factor) in this manifest. This is strictly to avoid biasing your detection rates in one sample vs the others and these counts will not be used for any other part of the analysis.

### dRIP_filt Options
__*-i*__	Required. Input decompressed bed file from dREG (ending in *dREG.peak.full.bed*).

__*-o*__	Required. Output file prefix.

__*-s*__	Optional. Score cutoff to be used for peak filtering (default = 0.5).

__*-p*__	Optional. p-value cutoff to be used for peak filtering (default = 0.025).

__*-b*__	Required. Comma-separated table of 3' bedgraph locations (details below)

__*-c*__	Optional. Minimum + and - strand counts required in maximum count sample (default = 10 reads on each strand)

__*-n*__	Optional. Number of samples to reach minimum count threshold (default = 1)


### dRIP_filt Output Files
__*[prefix]_s0.5p0.025c10n1_filtered.bed*__	Filtered dREG peaks in standard bed file format. Score column is the dREG score multiplied by 1000 and made into an integer. Peak centers cover 10bp and adjusted to fall within the start and end of their dREG peaks. The suffix is generated by the parameters used: s[score cutoff]p[p-value cutoff]c[read count cutoff]n[number of samples to meet read count cutoff]

__*[prefix]_scatter.pdf*__	Scatter plots depicting cutoffs used. Cutoffs can be adjusted to better fit the data. Recommended minimum score cutoff of 0.5 and maximum p-value of 0.025 to start.

### Filtering Notes
The suggested starting cutoffs for dREG peak filtering is a score of >=0.5 and a p-value <=0.025. This is due to an odd quirk of how dREG calculates scores and p-values which leads to peaks having seemingly random scores (the vertical "bar" seen to the left of these scatter plots). Cutoffs should be adjusted to avoid inclusion of dREG peaks with scores within this bar. In this case, cutoffs of a score >=0.5 and a p-value <= 0.023 was deemed appropriate (lines shown on plots). 

**Important Note:** check the number of dREG peaks you have after filtering. For a typical library depth (30-40M mapped reads), you can expect ~60k peaks in samples with low complexity (one/two conditions, knock-downs, etc) up to ~120k peaks for high complexity samples (comparing multiple cell lines, cancer samples, or differentiation assays). If you get below 50k, try easing up on the count filter threshold.

## dREG Peak Annotation by CoGENT
Script developed by Andrew Field. Filtered dREG peaks are annotated by their proximity to active genes. This script also filters putative enhancer peaks by overlap with problematic repeats and functional RNA species (eg rRNAs and tRNAs). Peaks overlapping low confidence transcript promoters (determined by biotype and transcript support level) will be flagged though will still be included as putative enhancers.

Required R Packages: optparse, dplyr, IRanges, tidyr, vroom

Other Required Tools: BedTools (https://bedtools.readthedocs.io/en/latest/content/installation.html)

Typical Usage
```
Rscript --vanilla /n/data1/hms/bcmp/adelman/Scripts/EnhancerAnnotation/CoGENT.R -i <dRIP filtered bed> -o out -c <basic gtf> -a <GGA Output>_Dominant.TSS.TES.calls.bed -T <GGA Output>_Annotated_Dominant_and_Nondominant_obsTSS_fordREG.txt -d TSS -p 1000 -m 1000000 -g 1000 -r <genome>.rmsk.txt
```
You'll need to replace the above <> brackets with inputs specific to your data and genome of interest. The "--vanilla" flag allows you to pass arguments from bash to R.

### Downloading RepeatMasker Annotation in your Genome of Interest
This script requires use of the RepeatMasker database. RepeatMasker tables are maintained in the respective annotation folders (along with basic gene GTFs) on the Adelman O2 directories. You can also download the most recent version for your genome (eg mm10, hg38, etc) using the following command:

```
wget http://hgdownload.cse.ucsc.edu/goldenpath/<genome>/database/rmsk.txt.gz
gunzip rmsk.txt.gz
```
Replace <> with your preferred genome on the UCSC Genome Browser.

### CoGENT Options
__*-i*__	Filtered dREG peak file. This is the BED file output from dRIP_filt.R.

__*-o*__	Output file prefix

__*-c*__	Basic GTF annotation file (Needs to include gene level annotations!)

__*-a*__	Filtered active transcript models in bed file format from GGA ([prefix]annotations_Dominant.TSS.TES.calls.bed)

__*-T*__	Observed TSS detailed file from GGA or TSScall/TSSclarify ([prefix]Annotated_Dominant_and_Nondominant_obsTSS_fordREG.txt)

__*-d*__	(Optional) Option for measuring distance from TSS (TSS) or Gene Bodies (GB). Default it TSS.

__*-p*__	(Optional) Promoter proximal distance – the distance from an annotated or observed TSS that is considered promoter proximal. Default is 1000 (1kb).

__*-m*__	Maximum distance for enhancer to gene associations. The default is 1000000 (1Mb).

__*-g*__	Gap distance between adjacent enhances in called enhancer clusters. The default is 1000 (1kb).

__*-r*__	RepeatMasker annotation text file (decompressed).

__*-R*__	(Optional) RepeatMasker classes to filter putative enhancers as a comma-separated list.
Defaults: rRNA,snRNA,scRNA,srpRNA,tRNA

__*-f*__	(Optional) Gencode biotypes for functional RNA species to be excluded from putative enhancers. Enhancer peaks with any overlap to these elements will be removed from the putative enhancer list.
Defaults: snoRNA,Mt_rRNA,miRNA,scaRNA,scRNA,snRNA,Mt_tRNA,ribozyme

__*-s*__	(Optional) Gencode biotypes that will not be filtered by transcript support level as a comma-separated list. All transcripts with these biotypes from the basic GTF will be kept as potential "inactive" transcript locations.
Defaults: protein_coding,snRNA

__*-t*__	(Optional) Minimum transcript support level (TSL) for inactive transcripts (biotypes provided with the -s flag are suppressed from this filter – eg all "protein_coding" transcripts, regardless of TSL, will be kept in the inactive transcripts pool).
Default = 3 (requiring TSL of 1, 2, or 3 -- NA is always removed)

### CoGENT Output Files
__*[prefix]_conflicted_annotation_entries.bed*__	Entries in active transcript model bed file where the TSS occurs downstream of the TES. This typically happens at short genes (eg snRNAs) where accurate obsTSS's are difficult to call. These entries are excluded from further analysis.

__*[prefix]_dREGannotate.RData*__	The raw R data is saved in case custom output tables are desired.

__*[prefix]_neighbor_histograms.pdf*__	Histograms displaying the distance to the closest dREG peak neighbor at different bin sizes for determining enhancer cluster gap distance cutoff. The gap distance cutoff is shown as a red dotted line.

__*[prefix]_peak_clusters.pdf*__	Histogram showing the number of peaks per cluster with the given gap distance cutoff.

__*[prefix]_dREGpeak_annotation.txt*__	Text file look-up table for dREG annotation categories. Strand information on overlapping gene transcripts are provided (or "." for no overlap). Excel safe.

__*[prefix]_distal_dREGpeak_closestGenes.txt*__ 	dREG peak centric text file for the closest 2 genes to each distal (non-promoter proximal) peak. Includes distance measures to TSS or gene body (as specified in the options) and biotype information. Excel safe.

__*[prefix]_dREGpeakClusters.txt*__	Annotations of dREG peak clusters with 2 or more members. Includes information on the coordinates of the cluster, the number of constituent peaks, the peak IDs, genomic category (promoter proximal/distal/intergenic/intragenic), overlapping genes (if applicable), and closest active gene (if applicable). Excel safe.

__*[prefix]_gene_histograms.pdf*__	Histograms displaying the distance to the closest closest gene at different bin sizes for determining promoter proximal and maximal distance cutoffs.

__*[prefix]_gene-centric_closest-dREGpeaks.txt*__	Gene centric list showing closest distal dREG peak plus a comma separated list of all associated distal dREG peaks. Excel safe.

__*[prefix]_promprox.txt*__	dREG peak centric list of all promoter proximal peaks and their associated genes at the given promoter proximal distance cutoff. This includes whether the peak overlaps the dominant transcription start site as well as how many reads support that start site. Multiple entries may exist for a single dREG peak if it overlaps multiple promoters.

__*[prefix]_RNA_rmsk_filtered_peaks.txt*__	A list of peaks overlapping filtered RepeatMasker elements and functional RNA biotypes.

__*[prefix]_intragenic.txt*__	Intragenic enhancer peaks along with their overlapping gene annotations. It is recommended to use the strandedness of the overlapping genes to count antisense strand reads when considering the activity of these peaks!

### CoGENT Parameter Considerations
#### Promoter Proximal Distance (-p)
Promoter proximal distance is critical for how you define an enhancer element and could vary by species (eg you may want to use a tighter window for fly than in mammals). To help define this window in a data-driven way, the pipeline outputs several histograms in [prefix]gene_histograms.pdf.
#### Gap Distance (-g)
Gap distance will determine how "greedy" the script is to pull together clusters of dREG peaks. To get a handle on how close dREG peaks tend to be in your data set, you can look at the output histograms in [prefix]neighbor_histograms.pdf.

### Making Sense of CoGENT Output
Below I'll discuss the output tables and some considerations in using them. There are some important notes here about duplicate entries and peak strandedness that could occur, especially in the intragenic and promoter proximal tables! Output table names have flags embedded into the file names to keep track of your settings. Only the settings that influence the content of the tables are provided. Examples below:

> _p1000  = promoter proximal distance 1000bp

> _m1000000  = max enhancer-gene linkage distance 1000000bp

> _g1000 = dREG peak cluster gap disatnace 1000bp


#### [prefix]dREGpeak_Annotation.txt
This is the main output most users would be interested in. It features all dREG peaks (after repeat and functional RNA filtering) along with their determined genomic categories. Below is a table of the included columns and their meaning:

__*gene_strand*__
> If the peak overlaps a gene (only relevant for promoter proximal and intragenic peaks), this indicates the strand of the overlapping gene annotation. When counting reads overlapping dREG peaks, it is recommended to keep only antisense reads for intragenic peaks, but keep all reads overlapping intergenic and promoter proximal peaks.

__*genomicCategory*__
> End categorization of dREG peaks.

> "Intergenic Transcribed Loci" = dREG peaks with no overlap with gene transcripts. Considered putative enhancers and reads on both strands can be considered when measuring their activity.

> "Intragenic Transcribed Loci" = dREG peaks that overlap gene bodies but are distal to TSS's. Considered putative enhancers though counting reads antisense to their overlapping genes to measure their activity is highly recommend.

> "Promoter Proximal Elements" = dREG peaks that are within the distance cutoff (default 1kb) from annotated transcription start sites. These peaks are not considered putative enhancers.

__*localGeneStatus*__
> If the peak is promoter proximal or intragenic, the overlapping gene status is shown here (as determined by GGA and the provided basic GTF).

> "NA" = no overlapping gene annotation.

> "Active" = GGA identified this gene as active.

> "Unstable" = GGA identified this gene as unstable. This can occur when the TSS is identified but the transcript was not present in RNA-seq.

> "Inactive" = Gene was not detected by GGA but is present in the basic GTF annotation.

> "Suppressed" = Gene was present in the basic GTF annotation, but was suppressed from dREG filtering due to low transcript support level and biotype. These are considered "distal" and "intergenic" peaks by CoGENT for all other purposes.

__*peak_chr, peak_start, peak_end, peak_center_start, peak_center_end*__
> dREG peak coordinates.

__*peak_score*__
> dREG peak score multiplied by 1000.

__*peakID*__
> A unique identifier for each dREG peak. 

__*rmskOverlap*__
> Overlap with common repeat elements are provided as a semi-colon separated list here. These entries are of the form [Class]:[Family]:[Name]

__*TSSproximity*__
> This evaluates whether a dREG peak is TSS proximal (promoter) or distal (putative enhancer).

> "Distal" = beyond the distance threshold for promoter proximal peaks (default: 1kb). These are considered unambiguous putative enhancer sites.

> "Dominant Promoter" = Within the distance threshold to a dominant transcript TSS (as provided by GGA).

> "Non-Dominant Promoter" = Within the distance threshold to an annotated TSS of an active gene, but not the one considered dominant by GGA. This occurs when a gene has multiple annotated TSS's.

> "Unstable Promoter" = TSS was detected by PRO-seq but absent in RNA-seq.

> "Inactive Gene Promoter" = Gene present in basic GTF annotation, but not called active by GGA. These are not considered putative enhancers.

> "Suppressed Gene Promoter" = Overlaps a TSS of a gene annotation suppressed from the basic GTF due to low transcript support level and biotype.


#### [prefix]intragenic.txt
This table provides details specific to intragenic peaks (those that overlap gene bodies but are distal to promoters). Note that there could be duplicate entries for some peaks that overlap multiple gene bodies (in the case where two genes overlap). For this reason, use caution when counting how many peaks fit a certain filtering criteria from this table!

__*localGeneStatus*__
> Overlapping gene activity status as determined by GGA.  Can be "active" (detected in both PRO-seq and RNA-seq) or "inactive" (missing from RNA-seq).

__*TSSdominance*__
> For the overlapping transcript, this column considers if it is considered the dominant or non-dominant transcript. Possible values below:

> "dominant" = overlapping transcript has the dominant TSS for the gene.

> "non-dominant" = overlapping transcript has a non-dominant TSS for the gene. This can happen when there are multiple transcript isoforms for a gene. This is a rare category since non-dominant isoform TSS's often occur close together so peaks in this range end up called as promoter proximal.

> "suppressed" = overlapping a transcript that has been suppressed from the basic annotation GTF due to low transcript support level and biotype. These peaks are considered as intergenic in other tables, but the details are provided here in case a user would like to take a closer look. If filtering for true intragenic peaks, these should be removed!

__*geneID, geneName, source, biotype, chr, start, end, strand*__
> Information on the gene and its genomic coordinates.
obsTSS	The observed TSS for the gene from GGA. This may be different from the provided gene coordinates! NA indicates that there was no detected dominant TSS in the PRO-seq data.

__*attributes*__
> The full attributes list of the overlapping gene from the input basic GTF.


#### [prefix]promprox.txt
This table provides details specific to promoter proximal peaks. Note that there could be duplicate entries for some peaks that overlap multiple gene promoter regions. This occurs often with divergent transcripts. For this reason, use caution when counting how many peaks fit a certain filtering criteria from this table!

__*localGeneStatus*__
> Overlapping gene activity status as determined by GGA.

> "active" = detected in both PRO-seq and RNA-seq

> "inactive" = missing from PRO-seq and RNA-seq

> "unstable" = TSS detected in PRO-seq but transcript was absent from RNA-seq

> "Suppressed" = transcript annotation that was suppressed from the basic annotation GTF due to low transcript support level and biotype. These peaks are considered as intergenic in other tables, but the details are provided here in case a user would like to take a closer look. If filtering for true promoter-proximal peaks, these should be removed!

__*TSSdominance*__	
> For the overlapping transcript, this column considers if it is considered the dominant or non-dominant transcript. Possible values below:

> "dominant" = overlapping transcript has the dominant TSS for the gene.

> "non-dominant" = the overlapping TSS is marked as "non-dominant" by GGA. This can happen when there are multiple transcript isoforms for a gene.

> "NA" = overlapping a transcript that has been suppressed from the basic annotation GTF due to low transcript support level and biotype. These peaks are considered as intergenic in other tables, but the details are provided here in case a user would like to take a closer look. If filtering for true promoter-proximal peaks, these should be removed!

__*geneID, geneName, source, biotype, chr, start, end, strand*__
> Information on the gene and its genomic coordinates.
obsTSS	The observed TSS for the gene from GGA. This may be different from the provided gene coordinates! NA indicates that there was no detected dominant TSS in the PRO-seq data.

__*reads@obsTSS*__
> Number of PRO-seq reads supporting the observed TSS position. This is summed across all provided samples.
dREGpeak_overlap	The degree of overlap (in bp) between the dREG peak and promoter proximal window (default +/- 1kb from indicated TSS). This is provided to break ties for peaks that overlap multiple promoter regions.

__*TSS_in_dREGpeak*__
> Boolean (TRUE/FALSE) for whether the observed TSS is contained within the dREG peak coordinates. NA indicates that there was no observed TSS in PRO-seq for the respective gene transcript.

__*attributes*__	
> The full attributes list of the overlapping gene from the input basic GTF.


#### [prefix]gene-centric_closest-dREGpeaks.txt
This is the main table providing gene to enhancer linkages to predict functional pairs. It is centered on each gene and provides details on the closest enhancer peak, then lists all other associated peaks. An enhancer and gene are considered pairs when two conditions are met: 1) the gene is one of the two closest active genes to the enhancer and 2) the distance between the enhancer and the gene TSS is less than a megabase (using default settings). This table is meant to be used to give likely enhancers influence genes of interest.

__*closest_peak*__	
> Closest dREG peak ID.

__*closest_distance*__	
> Distance from dREG peak (closest edge) to TSS (default). Negative values are upstream and positive values are downstream from the gene.

__*peak_count*__
> Number of dREG peaks associated with the listed gene. peakIDs	Comma-separated list of all associated dREG peaks.


#### [prefix]distal_dREGpeak_closestGenes.txt
This table provides the genes associated with each distal dREG peak (putative enhancers which include both intergenic and intragenic peaks). Entries are listed from a dREG peak centric perspective. This can be used to directly go from changed enhancer lists to a list of likely gene targets.

__*peak_genomicCategory*__
> "Intergenic Transcribed Locus" = Does not overlap a gene annotation.
> "Intragenic Transcribed Locus" = Overlaps a gene body.
> "Suppressed Promoter Proximal" = Overlaps a suppressed promoter element (removed due to low transcript support level and biotype). Should be considered as an "Intergenic Transcribed Locus".

__*peak_overlappingGeneStatus*__
> "Active" = gene is called active by GGA.
> "Inactive" = gene is not present in GGA, but is found in the basic GTF (and meets minimal transcript support level and biotype filtering)
> "NA" = peak does not overlap a gene annotation.

__*gene[1 or 2]_geneID, gene[1 or 2]_name, gene[1 or 2]_chr, 
gene[1 or 2]_start, gene[1 or 2]_end, gene[1 or 2]_strand, 
gene[1 or 2]_obsTSS, gene[1 or 2]_reads@obsTSS, 
gene[1 or 2]_biotype, gene[1 or 2]_attributes*__	
> Information on nearest gene elements. Columns beginning with "gene1_*" represent the closest gene to the enhancer. "gene2_*" columns are for the second closest gene. This information is grabbed from the basic GTF provided to CoGENT. "NA" values in these columns represent dREG peaks found in gene deserts without a 1st or 2nd closest gene within the cutoff distance (1Mb by default).

__*gene[1 or 2]_peak_distance_to_TSS*__	

> Distance from dREG peak edge to closest (gene1) or second closest (gene2) transcription start site. Negative values are upstream, positive values are downstream from the gene.

#### [prefix]dREGpeakClusters.txt
This table provides information for defining enhancer clusters or "Super Enhancers" from your PRO-seq data. The complimentary *_neighbor_histograms.pdf and *_peak_clusters.pdf histogram plots can help you make a determination for what a good cutoff for calling enhancer clusters might be in your data.

__*clusterID*__	
> Unique cluster identifier.

__*cluster_chr, cluster_start, cluster_end*__
> Coordinates of cluster footprint. Defined as the start of the first dREG peak and the end of the last dREG peak on the genomic coordinates.

__*peak_count*__
> If at least two peaks are within the cluster distance (default = 1kb), then they are merged into a cluster of peaks (minimum 2). This is the count of the number of dREG peaks within the cluster. Roughly, this can be related to the number of TF binding sites and transcription initiation sites within the cluster. It is recommended to define enhancer clusters to require a minimum number of peaks. In mouse ESCs, 4-5 peaks is a good cutoff to match those defined by MED1 ChIP-seq from the Young Lab.

__*peak_IDs*__
> A comma-separated list of dREGpeak ID's.

__*TSSproximity*__	
> If any part of the peak cluster coordinates overlaps a promoter proximal region (default +/- 1kb from annotated TSS's), it is noted here.

> "Distal" = No overlap

> "Dominant" = Overlaps a dominant TSS defined by GGA.

> "Non-dominant" = Overlaps either an inactive gene promoter or the non-dominant TSS for an active gene.

#### [prefix]RNA_rmsk_filtered_peaks.txt
This table contains dREG peaks that have been filtered out due to overlap with repeat or functional RNA elements. This output is not meant to be used except for QC purposes or if there is a particular RNA class of interest. A typical number of peaks to end up in this table is <1000.

#### [prefix]conflicted_annotation_entries.bed
This is a bed file containing GGA active genes with conflicting start and end sites (eg an end site coordinate before a start coordinate). This can happen particularly with adjusted TSS coordinates for small genes. With the current updates to GGA, this table should be empty, but has been kept as an output for QC purposes.

## Centering dREG Peaks by Dominant TSS's with TSScent.R
The peak centers that dREG provides are fuzzy at best. For this reason, I have developed a script to comb through TSScall (or GGA detailed TSS) output to identify the TSS "winners" within each dREG peak. This can also be co-opted to find TSS centers for other peak types (eg ATAC-seq or ChIP-seq peaks) as it only needs a BED file format (BED6 or BED8) and the detail table from TSScall. This can be run before or after CoGENT, but should be after dRIP_filt.R. If desired, dREG peaks can be filtered by if they have an obsTSS or not as detected by this script.

Typical Usage
```
Rscript --vanilla /n/data1/hms/bcmp/adelman/Scripts/EnhancerAnnotation/TSScent.R -i <input.filtered>.bed -o <output prefix> -t <TSSclassify_detail_file>.txt
```
Replace <> brackets in the final line with your desired file names. This requires the TSScall detailed output run through TSSclassify (this is provided in GGA output as well) and a peak file in BED 6 or BED 8 format!

### TSScentR Output
#### [prefix]TSSwinners.txt
This is the only output of this script. Descriptions of unique table columns below:

__*centerStart, centerEnd*__
> The provided peak centers. This is reported if the input BED file was in BED8 format (typical of dREG peaks). Otherwise, these columns will say "NoCenter".

__*TSS_count*__
> The number of TSS's detected within the provided peak.

__*TSS_IDs*__	
> The TSS ID's provided in the TSScall detail file. These are of the form "nuTSS_xxxxx" or "obsTSS_xxxxx".

> nuTSS_xxxxx = TSS detected beyond the search window of annotated transcript TSS's.

> obsTSS_xxxxxx = TSS detected within the search window of annotated transcript TSS's. Peaks with obsTSS's can be filtered depending on your application.

__*TSS_winner_ID*__
> The overlapping TSS with the most supporting reads. Ties are broken by lowest TSS ID (bias toward positive strand, but this is a rare event).

__*TSS_winner_position*__
> bp position of TSS winner (0-based coordinates).

__*TSS_winner_strand*__
Direction of TSS.

__*TSS_winner_reads*__
> Reads supporting TSS location. Exact 5' read end coordinate.

__*TSS_[plus/minus]_ID, TSS_[plus/minus]_position, TSS_[plus/minus]_reads*__
> The ID, position, and supporting reads for the plus strand or minus strand TSS winner. Winners for each strand are provided to track convergent or divergent transcription at your peaks.

__*gap_distance*__
> The distance between the positive and minus strand TSS winners. A positive number indicates divergent transcription. A negative number is convergent transcription.

__*divergent*__
> Boolean TRUE/FALSE value of if the observed TSS's are convergent or divergent. Requires at least 1 positive strand TSS and 1 negative strand TSS.
Note: You may wish to filter out dREG peaks with 0 overlapping TSS's. These are peaks where there are no TSS's over the TSScall thresholds. This could be due to either low transcription or an ill-defined TSS. It is best to remove these for metagene plots and heatmaps, though may still want to be considered for enhancer analysis (eg DESeq2 and clustering). In the end, it depends on the project and focus for your dataset.
